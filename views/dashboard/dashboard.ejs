<!-- 
  File: /views/dashboard/dashboard.ejs
  Purpose: User dashboard displaying submitted testimonials with edit links
  Notes:
  - Renders inside the main layout (no full HTML)
  - Expects 'testimonials' array passed in
-->

<h2>Your bookings</h2>
<% if (!bookings || bookings.length === 0) { %>
  <p>No bookings found.</p>
<% } else { %>
  <ul>
    <% bookings.forEach(booking => { %>
      <li>
        <strong>Date:</strong> <%= booking.preferredDate ? new Date(booking.preferredDate).toDateString() : 'N/A' %><br />
        <strong>Service:</strong> <%= booking.serviceType %><br />
        <strong>Notes:</strong> <%= booking.notes || 'None' %><br />
        <a href="/booking/edit/<%= booking._id %>">Edit</a>
        <form action="/booking/delete/<%= booking._id %>" method="POST" style="display:inline;">
          <button type="submit" onclick="return confirm('Are you sure you want to delete this booking?')">Delete</button>
        </form>
      </li>
    <% }) %>
  </ul>
<% } %>

<hr>

<h2>Your testimonials</h2>
<% if (!testimonials || testimonials.length === 0) { %>
  <p>No testimonials found.</p>
<% } else { %>
  <ul>
    <% testimonials.forEach(testimonial => { %>
      <li>
        <strong>Submitted on:</strong> <%= testimonial.createdAt ? testimonial.createdAt.toDateString() : 'N/A' %><br />
        <div><%- testimonial.content %></div><br />
        <a href="/testimonials/edit/<%= testimonial._id %>">Edit</a>
        <form action="/testimonials/delete/<%= testimonial._id %>" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this testimonial?');">
          <button type="submit">Delete</button>
        </form>
      </li>
    <% }) %>
  </ul>
<% } %>

